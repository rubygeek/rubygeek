var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/common"),require("@angular/core"),require("rxjs/add/operator/map"),require("rxjs/add/operator/mergeMap"),require("rxjs/add/operator/mergeAll"),require("rxjs/add/operator/reduce"),require("rxjs/add/operator/every"),require("rxjs/Subject"),require("rxjs/observable/from"),require("rxjs/observable/of"),require("rxjs/add/operator/first"),require("rxjs/add/operator/catch"),require("rxjs/add/operator/concatAll"),require("rxjs/Observable"),require("rxjs/util/EmptyError"),require("rxjs/observable/fromPromise"),require("rxjs/add/operator/last"),require("rxjs/BehaviorSubject"),require("rxjs/add/operator/toPromise"),require("rxjs/observable/forkJoin"),require("@angular/platform-browser")):"function"==typeof define&&define.amd?define(["exports","@angular/common","@angular/core","rxjs/add/operator/map","rxjs/add/operator/mergeMap","rxjs/add/operator/mergeAll","rxjs/add/operator/reduce","rxjs/add/operator/every","rxjs/Subject","rxjs/observable/from","rxjs/observable/of","rxjs/add/operator/first","rxjs/add/operator/catch","rxjs/add/operator/concatAll","rxjs/Observable","rxjs/util/EmptyError","rxjs/observable/fromPromise","rxjs/add/operator/last","rxjs/BehaviorSubject","rxjs/add/operator/toPromise","rxjs/observable/forkJoin","@angular/platform-browser"],factory):factory((global.ng=global.ng||{},global.ng.router=global.ng.router||{}),global.ng.common,global.ng.core,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx,global.Rx.Observable,global.Rx.Observable,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx.Observable.prototype,global.Rx,global.Rx.EmptyError,global.Rx.Observable,global.Rx.Observable.prototype,global.Rx,global.Rx.Observable.prototype,global.Rx.Observable,global.ng.platformBrowser)}(this,function(exports,_angular_common,_angular_core,rxjs_add_operator_map,rxjs_add_operator_mergeMap,rxjs_add_operator_mergeAll,rxjs_add_operator_reduce,rxjs_add_operator_every,rxjs_Subject,rxjs_observable_from,rxjs_observable_of,rxjs_add_operator_first,rxjs_add_operator_catch,rxjs_add_operator_concatAll,rxjs_Observable,rxjs_util_EmptyError,rxjs_observable_fromPromise,rxjs_add_operator_last,rxjs_BehaviorSubject,rxjs_add_operator_toPromise,rxjs_observable_forkJoin,_angular_platformBrowser){"use strict";function shallowEqualArrays(a,b){if(a.length!==b.length)return!1;for(var i=0;i<a.length;++i)if(!shallowEqual(a[i],b[i]))return!1;return!0}function shallowEqual(a,b){var k1=Object.keys(a),k2=Object.keys(b);if(k1.length!=k2.length)return!1;for(var key,i=0;i<k1.length;i++)if(key=k1[i],a[key]!==b[key])return!1;return!0}function flatten(a){for(var target=[],i=0;i<a.length;++i)for(var j=0;j<a[i].length;++j)target.push(a[i][j]);return target}function last(a){return a.length>0?a[a.length-1]:null}function merge(m1,m2){var m={};for(var attr in m1)m1.hasOwnProperty(attr)&&(m[attr]=m1[attr]);for(var attr in m2)m2.hasOwnProperty(attr)&&(m[attr]=m2[attr]);return m}function forEach(map,callback){for(var prop in map)map.hasOwnProperty(prop)&&callback(map[prop],prop)}function waitForMap(obj,fn){var waitFor=[],res={};return forEach(obj,function(a,k){k===PRIMARY_OUTLET&&waitFor.push(fn(k,a).map(function(_){return res[k]=_,_}))}),forEach(obj,function(a,k){k!==PRIMARY_OUTLET&&waitFor.push(fn(k,a).map(function(_){return res[k]=_,_}))}),waitFor.length>0?rxjs_observable_of.of.apply(rxjs_observable_of,waitFor).concatAll().last().map(function(last){return res}):rxjs_observable_of.of(res)}function andObservables(observables){return observables.mergeAll().every(function(result){return result===!0})}function wrapIntoObservable(value){return value instanceof rxjs_Observable.Observable?value:value instanceof Promise?rxjs_observable_fromPromise.fromPromise(value):rxjs_observable_of.of(value)}function createEmptyUrlTree(){return new UrlTree(new UrlSegmentGroup([],{}),{},null)}function containsTree(container,containee,exact){return exact?equalSegmentGroups(container.root,containee.root):containsSegmentGroup(container.root,containee.root)}function equalSegmentGroups(container,containee){if(!equalPath(container.segments,containee.segments))return!1;if(container.numberOfChildren!==containee.numberOfChildren)return!1;for(var c in containee.children){if(!container.children[c])return!1;if(!equalSegmentGroups(container.children[c],containee.children[c]))return!1}return!0}function containsSegmentGroup(container,containee){return containsSegmentGroupHelper(container,containee,containee.segments)}function containsSegmentGroupHelper(container,containee,containeePaths){if(container.segments.length>containeePaths.length){var current=container.segments.slice(0,containeePaths.length);return!!equalPath(current,containeePaths)&&!containee.hasChildren()}if(container.segments.length===containeePaths.length){if(!equalPath(container.segments,containeePaths))return!1;for(var c in containee.children){if(!container.children[c])return!1;if(!containsSegmentGroup(container.children[c],containee.children[c]))return!1}return!0}var current=containeePaths.slice(0,container.segments.length),next=containeePaths.slice(container.segments.length);return!!equalPath(container.segments,current)&&(!!container.children[PRIMARY_OUTLET]&&containsSegmentGroupHelper(container.children[PRIMARY_OUTLET],containee,next))}function equalPath(a,b){if(a.length!==b.length)return!1;for(var i=0;i<a.length;++i)if(a[i].path!==b[i].path)return!1;return!0}function mapChildrenIntoArray(segment,fn){var res=[];return forEach(segment.children,function(child,childOutlet){childOutlet===PRIMARY_OUTLET&&(res=res.concat(fn(child,childOutlet)))}),forEach(segment.children,function(child,childOutlet){childOutlet!==PRIMARY_OUTLET&&(res=res.concat(fn(child,childOutlet)))}),res}function serializePaths(segment){return segment.segments.map(function(p){return serializePath(p)}).join("/")}function serializeSegment(segment,root){if(segment.hasChildren()&&root){var primary=segment.children[PRIMARY_OUTLET]?serializeSegment(segment.children[PRIMARY_OUTLET],!1):"",children_1=[];return forEach(segment.children,function(v,k){k!==PRIMARY_OUTLET&&children_1.push(k+":"+serializeSegment(v,!1))}),children_1.length>0?primary+"("+children_1.join("//")+")":""+primary}if(segment.hasChildren()&&!root){var children=mapChildrenIntoArray(segment,function(v,k){return k===PRIMARY_OUTLET?[serializeSegment(segment.children[PRIMARY_OUTLET],!1)]:[k+":"+serializeSegment(v,!1)]});return serializePaths(segment)+"/("+children.join("//")+")"}return serializePaths(segment)}function encode(s){return encodeURIComponent(s)}function decode(s){return decodeURIComponent(s)}function serializePath(path){return""+encode(path.path)+serializeParams(path.parameters)}function serializeParams(params){return pairs(params).map(function(p){return";"+encode(p.first)+"="+encode(p.second)}).join("")}function serializeQueryParams(params){var strs=pairs(params).map(function(p){return encode(p.first)+"="+encode(p.second)});return strs.length>0?"?"+strs.join("&"):""}function pairs(obj){var res=[];for(var prop in obj)obj.hasOwnProperty(prop)&&res.push(new Pair(prop,obj[prop]));return res}function matchSegments(str){SEGMENT_RE.lastIndex=0;var match=str.match(SEGMENT_RE);return match?match[0]:""}function matchQueryParams(str){QUERY_PARAM_RE.lastIndex=0;var match=str.match(SEGMENT_RE);return match?match[0]:""}function matchUrlQueryParamValue(str){QUERY_PARAM_VALUE_RE.lastIndex=0;var match=str.match(QUERY_PARAM_VALUE_RE);return match?match[0]:""}function noMatch(segmentGroup){return new rxjs_Observable.Observable(function(obs){return obs.error(new NoMatch(segmentGroup))})}function absoluteRedirect(segments){return new rxjs_Observable.Observable(function(obs){return obs.error(new AbsoluteRedirect(segments))})}function canLoadFails(route){return new rxjs_Observable.Observable(function(obs){return obs.error(new Error("Cannot load children because the guard of the route \"path: '"+route.path+"'\" returned false"))})}function applyRedirects(injector,configLoader,urlTree,config){return new ApplyRedirects(injector,configLoader,urlTree,config).apply()}function runGuards(injector,route){var canLoad=route.canLoad;if(!canLoad||0===canLoad.length)return rxjs_observable_of.of(!0);var obs=rxjs_observable_from.from(canLoad).map(function(c){var guard=injector.get(c);return wrapIntoObservable(guard.canLoad?guard.canLoad(route):guard(route))});return andObservables(obs)}function match(segmentGroup,route,segments){var noMatch={matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}};if(""===route.path)return(route.terminal||"full"===route.pathMatch)&&(segmentGroup.hasChildren()||segments.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};for(var path=route.path,parts=path.split("/"),positionalParamSegments={},consumedSegments=[],currentIndex=0,i=0;i<parts.length;++i){if(currentIndex>=segments.length)return noMatch;var current=segments[currentIndex],p=parts[i],isPosParam=p.startsWith(":");if(!isPosParam&&p!==current.path)return noMatch;isPosParam&&(positionalParamSegments[p.substring(1)]=current),consumedSegments.push(current),currentIndex++}return route.terminal&&(segmentGroup.hasChildren()||currentIndex<segments.length)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:consumedSegments,lastChild:currentIndex,positionalParamSegments:positionalParamSegments}}function applyRedirectCommands(segments,redirectTo,posParams){var r=redirectTo.startsWith("/")?redirectTo.substring(1):redirectTo;return""===r?[]:createSegments(redirectTo,r.split("/"),segments,posParams)}function createSegments(redirectTo,parts,segments,posParams){return parts.map(function(p){return p.startsWith(":")?findPosParam(p,posParams,redirectTo):findOrCreateSegment(p,segments)})}function findPosParam(part,posParams,redirectTo){var paramName=part.substring(1),pos=posParams[paramName];if(!pos)throw new Error("Cannot redirect to '"+redirectTo+"'. Cannot find '"+part+"'.");return pos}function findOrCreateSegment(part,segments){for(var idx=0,_i=0,segments_1=segments;_i<segments_1.length;_i++){var s=segments_1[_i];if(s.path===part)return segments.splice(idx),s;idx++}return new UrlSegment(part,{})}function split(segmentGroup,consumedSegments,slicedSegments,config){if(slicedSegments.length>0&&containsEmptyPathRedirectsWithNamedOutlets(segmentGroup,slicedSegments,config)){var s=new UrlSegmentGroup(consumedSegments,createChildrenForEmptySegments(config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)));return{segmentGroup:mergeTrivialChildren(s),slicedSegments:[]}}if(0===slicedSegments.length&&containsEmptyPathRedirects(segmentGroup,slicedSegments,config)){var s=new UrlSegmentGroup(segmentGroup.segments,addEmptySegmentsToChildrenIfNeeded(segmentGroup,slicedSegments,config,segmentGroup.children));return{segmentGroup:mergeTrivialChildren(s),slicedSegments:slicedSegments}}return{segmentGroup:segmentGroup,slicedSegments:slicedSegments}}function mergeTrivialChildren(s){if(1===s.numberOfChildren&&s.children[PRIMARY_OUTLET]){var c=s.children[PRIMARY_OUTLET];return new UrlSegmentGroup(s.segments.concat(c.segments),c.children)}return s}function addEmptySegmentsToChildrenIfNeeded(segmentGroup,slicedSegments,routes,children){for(var res={},_i=0,routes_1=routes;_i<routes_1.length;_i++){var r=routes_1[_i];emptyPathRedirect(segmentGroup,slicedSegments,r)&&!children[getOutlet$1(r)]&&(res[getOutlet$1(r)]=new UrlSegmentGroup([],{}))}return merge(children,res)}function createChildrenForEmptySegments(routes,primarySegmentGroup){var res={};res[PRIMARY_OUTLET]=primarySegmentGroup;for(var _i=0,routes_2=routes;_i<routes_2.length;_i++){var r=routes_2[_i];""===r.path&&getOutlet$1(r)!==PRIMARY_OUTLET&&(res[getOutlet$1(r)]=new UrlSegmentGroup([],{}))}return res}function containsEmptyPathRedirectsWithNamedOutlets(segmentGroup,slicedSegments,routes){return routes.filter(function(r){return emptyPathRedirect(segmentGroup,slicedSegments,r)&&getOutlet$1(r)!==PRIMARY_OUTLET}).length>0}function containsEmptyPathRedirects(segmentGroup,slicedSegments,routes){return routes.filter(function(r){return emptyPathRedirect(segmentGroup,slicedSegments,r)}).length>0}function emptyPathRedirect(segmentGroup,slicedSegments,r){return(!(segmentGroup.hasChildren()||slicedSegments.length>0)||!r.terminal&&"full"!==r.pathMatch)&&(""===r.path&&void 0!==r.redirectTo)}function getOutlet$1(route){return route.outlet?route.outlet:PRIMARY_OUTLET}function validateConfig(config){config.forEach(validateNode)}function validateNode(route){if(Array.isArray(route))throw new Error("Invalid route configuration: Array cannot be specified");if(route.redirectTo&&route.children)throw new Error("Invalid configuration of route '"+route.path+"': redirectTo and children cannot be used together");if(route.redirectTo&&route.loadChildren)throw new Error("Invalid configuration of route '"+route.path+"': redirectTo and loadChildren cannot be used together");if(route.children&&route.loadChildren)throw new Error("Invalid configuration of route '"+route.path+"': children and loadChildren cannot be used together");if(route.redirectTo&&route.component)throw new Error("Invalid configuration of route '"+route.path+"': redirectTo and component cannot be used together");if(void 0===route.redirectTo&&!route.component&&!route.children&&!route.loadChildren)throw new Error("Invalid configuration of route '"+route.path+"': one of the following must be provided (component or redirectTo or children or loadChildren)");if(void 0===route.path)throw new Error("Invalid route configuration: routes must have path specified");if(route.path.startsWith("/"))throw new Error("Invalid route configuration of route '"+route.path+"': path cannot start with a slash");if(""===route.path&&void 0!==route.redirectTo&&void 0===route.terminal&&void 0===route.pathMatch){var exp="The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.";throw new Error("Invalid route configuration of route '{path: \""+route.path+'", redirectTo: "'+route.redirectTo+"\"}': please provide 'pathMatch'. "+exp)}if(void 0!==route.pathMatch&&"full"!==route.pathMatch&&"prefix"!==route.pathMatch)throw new Error("Invalid configuration of route '"+route.path+"': pathMatch can only be set to 'prefix' or 'full'")}function findNode(expected,c){if(expected===c.value)return c;for(var _i=0,_a=c.children;_i<_a.length;_i++){var cc=_a[_i],r=findNode(expected,cc);if(r)return r}return null}function findPath(expected,c,collected){if(collected.push(c),expected===c.value)return collected;for(var _i=0,_a=c.children;_i<_a.length;_i++){var cc=_a[_i],cloned=collected.slice(0),r=findPath(expected,cc,cloned);if(r.length>0)return r}return[]}function createEmptyState(urlTree,rootComponent){var snapshot=createEmptyStateSnapshot(urlTree,rootComponent),emptyUrl=new rxjs_BehaviorSubject.BehaviorSubject([new UrlSegment("",{})]),emptyParams=new rxjs_BehaviorSubject.BehaviorSubject({}),emptyData=new rxjs_BehaviorSubject.BehaviorSubject({}),emptyQueryParams=new rxjs_BehaviorSubject.BehaviorSubject({}),fragment=new rxjs_BehaviorSubject.BehaviorSubject(""),activated=new ActivatedRoute(emptyUrl,emptyParams,emptyQueryParams,fragment,emptyData,PRIMARY_OUTLET,rootComponent,snapshot.root);return activated.snapshot=snapshot.root,new RouterState(new TreeNode(activated,[]),snapshot)}function createEmptyStateSnapshot(urlTree,rootComponent){var emptyParams={},emptyData={},emptyQueryParams={},fragment="",activated=new ActivatedRouteSnapshot([],emptyParams,emptyQueryParams,fragment,emptyData,PRIMARY_OUTLET,rootComponent,null,urlTree.root,(-1),InheritedResolve.empty);return new RouterStateSnapshot("",new TreeNode(activated,[]))}function setRouterStateSnapshot(state,node){node.value._routerState=state,node.children.forEach(function(c){return setRouterStateSnapshot(state,c)})}function serializeNode(node){var c=node.children.length>0?" { "+node.children.map(serializeNode).join(", ")+" } ":"";return""+node.value+c}function advanceActivatedRoute(route){route.snapshot?(shallowEqual(route.snapshot.queryParams,route._futureSnapshot.queryParams)||route.queryParams.next(route._futureSnapshot.queryParams),route.snapshot.fragment!==route._futureSnapshot.fragment&&route.fragment.next(route._futureSnapshot.fragment),shallowEqual(route.snapshot.params,route._futureSnapshot.params)||(route.params.next(route._futureSnapshot.params),route.data.next(route._futureSnapshot.data)),shallowEqualArrays(route.snapshot.url,route._futureSnapshot.url)||route.url.next(route._futureSnapshot.url),route.snapshot=route._futureSnapshot):(route.snapshot=route._futureSnapshot,route.data.next(route._futureSnapshot.data))}function createRouterState(curr,prevState){var root=createNode(curr._root,prevState?prevState._root:void 0);return new RouterState(root,curr)}function createNode(curr,prevState){if(prevState&&equalRouteSnapshots(prevState.value.snapshot,curr.value)){var value=prevState.value;value._futureSnapshot=curr.value;var children=createOrReuseChildren(curr,prevState);return new TreeNode(value,children)}var value=createActivatedRoute(curr.value),children=curr.children.map(function(c){return createNode(c)});return new TreeNode(value,children)}function createOrReuseChildren(curr,prevState){return curr.children.map(function(child){for(var _i=0,_a=prevState.children;_i<_a.length;_i++){var p=_a[_i];if(equalRouteSnapshots(p.value.snapshot,child.value))return createNode(child,p)}return createNode(child)})}function createActivatedRoute(c){return new ActivatedRoute(new rxjs_BehaviorSubject.BehaviorSubject(c.url),new rxjs_BehaviorSubject.BehaviorSubject(c.params),new rxjs_BehaviorSubject.BehaviorSubject(c.queryParams),new rxjs_BehaviorSubject.BehaviorSubject(c.fragment),new rxjs_BehaviorSubject.BehaviorSubject(c.data),c.outlet,c.component,c)}function equalRouteSnapshots(a,b){return a._routeConfig===b._routeConfig}function createUrlTree(route,urlTree,commands,queryParams,fragment){if(0===commands.length)return tree(urlTree.root,urlTree.root,urlTree,queryParams,fragment);var normalizedCommands=normalizeCommands(commands);if(validateCommands(normalizedCommands),navigateToRoot(normalizedCommands))return tree(urlTree.root,new UrlSegmentGroup([],{}),urlTree,queryParams,fragment);var startingPosition=findStartingPosition(normalizedCommands,urlTree,route),segmentGroup=startingPosition.processChildren?updateSegmentGroupChildren(startingPosition.segmentGroup,startingPosition.index,normalizedCommands.commands):updateSegmentGroup(startingPosition.segmentGroup,startingPosition.index,normalizedCommands.commands);return tree(startingPosition.segmentGroup,segmentGroup,urlTree,queryParams,fragment)}function validateCommands(n){if(n.isAbsolute&&n.commands.length>0&&isMatrixParams(n.commands[0]))throw new Error("Root segment cannot have matrix parameters");var c=n.commands.filter(function(c){return"object"==typeof c&&void 0!==c.outlets});if(c.length>0&&c[0]!==n.commands[n.commands.length-1])throw new Error("{outlets:{}} has to be the last command")}function isMatrixParams(command){return"object"==typeof command&&void 0===command.outlets&&void 0===command.segmentPath}function tree(oldSegmentGroup,newSegmentGroup,urlTree,queryParams,fragment){return urlTree.root===oldSegmentGroup?new UrlTree(newSegmentGroup,stringify(queryParams),fragment):new UrlTree(replaceSegment(urlTree.root,oldSegmentGroup,newSegmentGroup),stringify(queryParams),fragment)}function replaceSegment(current,oldSegment,newSegment){var children={};return forEach(current.children,function(c,outletName){c===oldSegment?children[outletName]=newSegment:children[outletName]=replaceSegment(c,oldSegment,newSegment)}),new UrlSegmentGroup(current.segments,children)}function navigateToRoot(normalizedChange){return normalizedChange.isAbsolute&&1===normalizedChange.commands.length&&"/"==normalizedChange.commands[0]}function normalizeCommands(commands){if("string"==typeof commands[0]&&1===commands.length&&"/"==commands[0])return new NormalizedNavigationCommands((!0),0,commands);for(var numberOfDoubleDots=0,isAbsolute=!1,res=[],_loop_1=function(i){var c=commands[i];if("object"==typeof c&&void 0!==c.outlets){var r_1={};return forEach(c.outlets,function(commands,name){"string"==typeof commands?r_1[name]=commands.split("/"):r_1[name]=commands}),res.push({outlets:r_1}),"continue"}if("object"==typeof c&&void 0!==c.segmentPath)return res.push(c.segmentPath),"continue";if("string"!=typeof c)return res.push(c),"continue";if(0===i)for(var parts=c.split("/"),j=0;j<parts.length;++j){var cc=parts[j];0==j&&"."==cc||(0==j&&""==cc?isAbsolute=!0:".."==cc?numberOfDoubleDots++:""!=cc&&res.push(cc))}else res.push(c)},i=0;i<commands.length;++i)_loop_1(i);return new NormalizedNavigationCommands(isAbsolute,numberOfDoubleDots,res)}function findStartingPosition(normalizedChange,urlTree,route){if(normalizedChange.isAbsolute)return new Position(urlTree.root,(!0),0);if(route.snapshot._lastPathIndex===-1)return new Position(route.snapshot._urlSegment,(!0),0);if(route.snapshot._lastPathIndex+1-normalizedChange.numberOfDoubleDots>=0)return new Position(route.snapshot._urlSegment,(!1),route.snapshot._lastPathIndex+1-normalizedChange.numberOfDoubleDots);throw new Error("Invalid number of '../'")}function getPath(command){return""+command}function getOutlets(commands){return"object"!=typeof commands[0]?(_a={},_a[PRIMARY_OUTLET]=commands,_a):void 0===commands[0].outlets?(_b={},_b[PRIMARY_OUTLET]=commands,_b):commands[0].outlets;var _a,_b}function updateSegmentGroup(segmentGroup,startIndex,commands){if(segmentGroup||(segmentGroup=new UrlSegmentGroup([],{})),0===segmentGroup.segments.length&&segmentGroup.hasChildren())return updateSegmentGroupChildren(segmentGroup,startIndex,commands);var m=prefixedWith(segmentGroup,startIndex,commands),slicedCommands=commands.slice(m.lastIndex);return m.match&&0===slicedCommands.length?new UrlSegmentGroup(segmentGroup.segments,{}):m.match&&!segmentGroup.hasChildren()?createNewSegmentGroup(segmentGroup,startIndex,commands):m.match?updateSegmentGroupChildren(segmentGroup,0,slicedCommands):createNewSegmentGroup(segmentGroup,startIndex,commands)}function updateSegmentGroupChildren(segmentGroup,startIndex,commands){if(0===commands.length)return new UrlSegmentGroup(segmentGroup.segments,{});var outlets_1=getOutlets(commands),children_2={};return forEach(outlets_1,function(commands,outlet){null!==commands&&(children_2[outlet]=updateSegmentGroup(segmentGroup.children[outlet],startIndex,commands))}),forEach(segmentGroup.children,function(child,childOutlet){void 0===outlets_1[childOutlet]&&(children_2[childOutlet]=child)}),new UrlSegmentGroup(segmentGroup.segments,children_2)}function prefixedWith(segmentGroup,startIndex,commands){for(var currentCommandIndex=0,currentPathIndex=startIndex,noMatch={match:!1,lastIndex:0};currentPathIndex<segmentGroup.segments.length;){if(currentCommandIndex>=commands.length)return noMatch;var path=segmentGroup.segments[currentPathIndex],curr=getPath(commands[currentCommandIndex]),next=currentCommandIndex<commands.length-1?commands[currentCommandIndex+1]:null;if(curr&&next&&"object"==typeof next&&void 0===next.outlets){if(!compare(curr,next,path))return noMatch;currentCommandIndex+=2}else{if(!compare(curr,{},path))return noMatch;currentCommandIndex++}currentPathIndex++}return{match:!0,lastIndex:currentCommandIndex}}function createNewSegmentGroup(segmentGroup,startIndex,commands){for(var paths=segmentGroup.segments.slice(0,startIndex),i=0;i<commands.length;){if("object"==typeof commands[i]&&void 0!==commands[i].outlets){var children=createNewSegmentChldren(commands[i].outlets);return new UrlSegmentGroup(paths,children)}if(0!==i||"object"!=typeof commands[0]){var curr=getPath(commands[i]),next=i<commands.length-1?commands[i+1]:null;curr&&next&&"object"==typeof next?(paths.push(new UrlSegment(curr,stringify(next))),i+=2):(paths.push(new UrlSegment(curr,{})),i++)}else{var p=segmentGroup.segments[startIndex];paths.push(new UrlSegment(p.path,commands[0])),i++}}return new UrlSegmentGroup(paths,{})}function createNewSegmentChldren(outlets){var children={};return forEach(outlets,function(commands,outlet){null!==commands&&(children[outlet]=createNewSegmentGroup(new UrlSegmentGroup([],{}),0,commands))}),children}function stringify(params){var res={};return forEach(params,function(v,k){return res[k]=""+v}),res}function compare(path,params,segment){return path==segment.path&&shallowEqual(params,segment.parameters)}function recognize(rootComponentType,config,urlTree,url){return new Recognizer(rootComponentType,config,urlTree,url).recognize()}function sortActivatedRouteSnapshots(nodes){nodes.sort(function(a,b){return a.value.outlet===PRIMARY_OUTLET?-1:b.value.outlet===PRIMARY_OUTLET?1:a.value.outlet.localeCompare(b.value.outlet)})}function getChildConfig(route){return route.children?route.children:route.loadChildren?route._loadedConfig.routes:[]}function match$1(segmentGroup,route,segments,parent){if(""===route.path){if((route.terminal||"full"===route.pathMatch)&&(segmentGroup.hasChildren()||segments.length>0))throw new NoMatch$1;var params=parent?parent.params:{};return{consumedSegments:[],lastChild:0,parameters:params}}for(var path=route.path,parts=path.split("/"),posParameters={},consumedSegments=[],currentIndex=0,i=0;i<parts.length;++i){if(currentIndex>=segments.length)throw new NoMatch$1;var current=segments[currentIndex],p=parts[i],isPosParam=p.startsWith(":");if(!isPosParam&&p!==current.path)throw new NoMatch$1;isPosParam&&(posParameters[p.substring(1)]=current.path),consumedSegments.push(current),currentIndex++}if((route.terminal||"full"===route.pathMatch)&&(segmentGroup.hasChildren()||currentIndex<segments.length))throw new NoMatch$1;var parameters=merge(posParameters,consumedSegments[consumedSegments.length-1].parameters);return{consumedSegments:consumedSegments,lastChild:currentIndex,parameters:parameters}}function checkOutletNameUniqueness(nodes){var names={};nodes.forEach(function(n){var routeWithSameOutletName=names[n.value.outlet];if(routeWithSameOutletName){var p=routeWithSameOutletName.url.map(function(s){return s.toString()}).join("/"),c=n.value.url.map(function(s){return s.toString()}).join("/");throw new Error("Two segments cannot have the same outlet name: '"+p+"' and '"+c+"'.")}names[n.value.outlet]=n.value})}function getSourceSegmentGroup(segmentGroup){for(var s=segmentGroup;s._sourceSegment;)s=s._sourceSegment;return s}function getPathIndexShift(segmentGroup){for(var s=segmentGroup,res=s._segmentIndexShift?s._segmentIndexShift:0;s._sourceSegment;)s=s._sourceSegment,res+=s._segmentIndexShift?s._segmentIndexShift:0;return res-1}function split$1(segmentGroup,consumedSegments,slicedSegments,config){if(slicedSegments.length>0&&containsEmptyPathMatchesWithNamedOutlets(segmentGroup,slicedSegments,config)){var s=new UrlSegmentGroup(consumedSegments,createChildrenForEmptyPaths(segmentGroup,consumedSegments,config,new UrlSegmentGroup(slicedSegments,segmentGroup.children)));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:[]}}if(0===slicedSegments.length&&containsEmptyPathMatches(segmentGroup,slicedSegments,config)){var s=new UrlSegmentGroup(segmentGroup.segments,addEmptyPathsToChildrenIfNeeded(segmentGroup,slicedSegments,config,segmentGroup.children));return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}var s=new UrlSegmentGroup(segmentGroup.segments,segmentGroup.children);return s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,{segmentGroup:s,slicedSegments:slicedSegments}}function addEmptyPathsToChildrenIfNeeded(segmentGroup,slicedSegments,routes,children){for(var res={},_i=0,routes_3=routes;_i<routes_3.length;_i++){var r=routes_3[_i];if(emptyPathMatch(segmentGroup,slicedSegments,r)&&!children[getOutlet$2(r)]){var s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=segmentGroup.segments.length,res[getOutlet$2(r)]=s}}return merge(children,res)}function createChildrenForEmptyPaths(segmentGroup,consumedSegments,routes,primarySegment){var res={};res[PRIMARY_OUTLET]=primarySegment,primarySegment._sourceSegment=segmentGroup,primarySegment._segmentIndexShift=consumedSegments.length;for(var _i=0,routes_4=routes;_i<routes_4.length;_i++){var r=routes_4[_i];if(""===r.path&&getOutlet$2(r)!==PRIMARY_OUTLET){var s=new UrlSegmentGroup([],{});s._sourceSegment=segmentGroup,s._segmentIndexShift=consumedSegments.length,res[getOutlet$2(r)]=s}}return res}function containsEmptyPathMatchesWithNamedOutlets(segmentGroup,slicedSegments,routes){return routes.filter(function(r){return emptyPathMatch(segmentGroup,slicedSegments,r)&&getOutlet$2(r)!==PRIMARY_OUTLET}).length>0}function containsEmptyPathMatches(segmentGroup,slicedSegments,routes){return routes.filter(function(r){return emptyPathMatch(segmentGroup,slicedSegments,r)}).length>0}function emptyPathMatch(segmentGroup,slicedSegments,r){return(!(segmentGroup.hasChildren()||slicedSegments.length>0)||!r.terminal&&"full"!==r.pathMatch)&&(""===r.path&&void 0===r.redirectTo)}function getOutlet$2(route){return route.outlet?route.outlet:PRIMARY_OUTLET}function getData(route){return route.data?route.data:{}}function getResolve(route){return route.resolve?route.resolve:{}}function resolve(resolver,state){return resolveNode(resolver,state._root).map(function(_){return state})}function resolveNode(resolver,node){if(0===node.children.length)return rxjs_observable_fromPromise.fromPromise(resolveComponent(resolver,node.value).then(function(factory){return node.value._resolvedComponentFactory=factory,node.value}));var c=node.children.map(function(c){return resolveNode(resolver,c).toPromise()});return rxjs_observable_forkJoin.forkJoin(c).map(function(_){return resolveComponent(resolver,node.value).then(function(factory){return node.value._resolvedComponentFactory=factory,node.value})})}function resolveComponent(resolver,snapshot){return snapshot.component&&snapshot._routeConfig&&"string"==typeof snapshot.component?resolver.resolveComponent(snapshot.component):Promise.resolve(null)}function closestLoadedConfig(state,snapshot){var b=state.pathFromRoot(snapshot).filter(function(s){var config=s._routeConfig;return config&&config._loadedConfig&&s!==snapshot});return b.length>0?b[b.length-1]._routeConfig._loadedConfig:null}function nodeChildrenAsMap(node){return node?node.children.reduce(function(m,c){return m[c.value.outlet]=c,m},{}):{}}function getOutlet(outletMap,route){var outlet=outletMap._outlets[route.outlet];if(!outlet){var componentName=route.component.name;throw route.outlet===PRIMARY_OUTLET?new Error("Cannot find primary outlet to load '"+componentName+"'"):new Error("Cannot find the outlet "+route.outlet+" to load '"+componentName+"'")}return outlet}function setupRouter(ref,resolver,urlSerializer,outletMap,location,injector,loader,config,opts){if(void 0===opts&&(opts={}),0==ref.componentTypes.length)throw new Error("Bootstrap at least one component before injecting Router.");var componentType=ref.componentTypes[0],r=new Router(componentType,resolver,urlSerializer,outletMap,location,injector,loader,flatten(config));return opts.enableTracing&&r.events.subscribe(function(e){console.group("Router Event: "+e.constructor.name),console.log(e.toString()),console.log(e),console.groupEnd()}),r}function rootRoute(router){return router.routerState.root}function initialRouterNavigation(router){return function(){router.initialNavigation()}}function provideRouter_(routes,config){return void 0===config&&(config={}),
[provideRoutes(routes),{provide:ROUTER_CONFIGURATION,useValue:config},_angular_common.Location,{provide:_angular_common.LocationStrategy,useClass:_angular_common.PathLocationStrategy},{provide:UrlSerializer,useClass:DefaultUrlSerializer},{provide:Router,useFactory:setupRouter,deps:[_angular_core.ApplicationRef,_angular_core.ComponentResolver,UrlSerializer,RouterOutletMap,_angular_common.Location,_angular_core.Injector,_angular_core.NgModuleFactoryLoader,ROUTES,ROUTER_CONFIGURATION]},RouterOutletMap,{provide:ActivatedRoute,useFactory:rootRoute,deps:[Router]},provideRouterInitializer(),{provide:_angular_core.NgModuleFactoryLoader,useClass:_angular_core.SystemJsNgModuleLoader}]}function provideRouterInitializer(){return{provide:_angular_core.APP_BOOTSTRAP_LISTENER,multi:!0,useFactory:initialRouterNavigation,deps:[Router]}}function provideRoutes(routes){return[{provide:_angular_core.ANALYZE_FOR_ENTRY_COMPONENTS,multi:!0,useValue:routes},{provide:ROUTES,multi:!0,useValue:routes}]}function provideRouterConfig(config){return{provide:ROUTER_CONFIGURATION,useValue:config}}function toBool(s){return""===s||!!s}function provideLocationStrategy(platformLocationStrategy,baseHref,options){return void 0===options&&(options={}),options.useHash?new _angular_common.HashLocationStrategy(platformLocationStrategy,baseHref):new _angular_common.PathLocationStrategy(platformLocationStrategy,baseHref)}function provideRouter(config,opts){return void 0===opts&&(opts={}),[{provide:_angular_common.PlatformLocation,useClass:_angular_platformBrowser.BrowserPlatformLocation}].concat(provideRouter_(config,opts))}var PRIMARY_OUTLET="primary",ROUTES=(new _angular_core.OpaqueToken("ROUTER_CONFIG"),new _angular_core.OpaqueToken("ROUTES")),LoadedRouterConfig=function(){function LoadedRouterConfig(routes,injector,factoryResolver){this.routes=routes,this.injector=injector,this.factoryResolver=factoryResolver}return LoadedRouterConfig}(),RouterConfigLoader=function(){function RouterConfigLoader(loader){this.loader=loader}return RouterConfigLoader.prototype.load=function(parentInjector,path){return rxjs_observable_fromPromise.fromPromise(this.loader.load(path).then(function(r){var ref=r.create(parentInjector);return new LoadedRouterConfig(flatten(ref.injector.get(ROUTES)),ref.injector,ref.componentFactoryResolver)}))},RouterConfigLoader}(),UrlTree=function(){function UrlTree(root,queryParams,fragment){this.root=root,this.queryParams=queryParams,this.fragment=fragment}return UrlTree.prototype.toString=function(){return(new DefaultUrlSerializer).serialize(this)},UrlTree}(),UrlSegmentGroup=function(){function UrlSegmentGroup(segments,children){var _this=this;this.segments=segments,this.children=children,this.parent=null,forEach(children,function(v,k){return v.parent=_this})}return UrlSegmentGroup.prototype.hasChildren=function(){return this.numberOfChildren>0},Object.defineProperty(UrlSegmentGroup.prototype,"numberOfChildren",{get:function(){return Object.keys(this.children).length},enumerable:!0,configurable:!0}),UrlSegmentGroup.prototype.toString=function(){return serializePaths(this)},UrlSegmentGroup}(),UrlSegment=function(){function UrlSegment(path,parameters){this.path=path,this.parameters=parameters}return UrlSegment.prototype.toString=function(){return serializePath(this)},UrlSegment}(),UrlSerializer=function(){function UrlSerializer(){}return UrlSerializer}(),DefaultUrlSerializer=function(){function DefaultUrlSerializer(){}return DefaultUrlSerializer.prototype.parse=function(url){var p=new UrlParser(url);return new UrlTree(p.parseRootSegment(),p.parseQueryParams(),p.parseFragment())},DefaultUrlSerializer.prototype.serialize=function(tree){var segment="/"+serializeSegment(tree.root,!0),query=serializeQueryParams(tree.queryParams),fragment=null!==tree.fragment&&void 0!==tree.fragment?"#"+encodeURIComponent(tree.fragment):"";return""+segment+query+fragment},DefaultUrlSerializer}(),Pair=function(){function Pair(first,second){this.first=first,this.second=second}return Pair}(),SEGMENT_RE=/^[^\/\(\)\?;=&#]+/,QUERY_PARAM_RE=/^[^=\?&#]+/,QUERY_PARAM_VALUE_RE=/^[^\?&#]+/,UrlParser=function(){function UrlParser(url){this.url=url,this.remaining=url}return UrlParser.prototype.peekStartsWith=function(str){return this.remaining.startsWith(str)},UrlParser.prototype.capture=function(str){if(!this.remaining.startsWith(str))throw new Error('Expected "'+str+'".');this.remaining=this.remaining.substring(str.length)},UrlParser.prototype.parseRootSegment=function(){return this.remaining.startsWith("/")&&this.capture("/"),""===this.remaining||this.remaining.startsWith("?")||this.remaining.startsWith("#")?new UrlSegmentGroup([],{}):new UrlSegmentGroup([],this.parseChildren())},UrlParser.prototype.parseChildren=function(){if(0==this.remaining.length)return{};this.peekStartsWith("/")&&this.capture("/");var paths=[];for(this.peekStartsWith("(")||paths.push(this.parseSegments());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),paths.push(this.parseSegments());var children={};this.peekStartsWith("/(")&&(this.capture("/"),children=this.parseParens(!0));var res={};return this.peekStartsWith("(")&&(res=this.parseParens(!1)),(paths.length>0||Object.keys(children).length>0)&&(res[PRIMARY_OUTLET]=new UrlSegmentGroup(paths,children)),res},UrlParser.prototype.parseSegments=function(){var path=matchSegments(this.remaining);if(""===path&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '"+this.remaining+"'.");this.capture(path);var matrixParams={};return this.peekStartsWith(";")&&(matrixParams=this.parseMatrixParams()),new UrlSegment(decode(path),matrixParams)},UrlParser.prototype.parseQueryParams=function(){var params={};if(this.peekStartsWith("?"))for(this.capture("?"),this.parseQueryParam(params);this.remaining.length>0&&this.peekStartsWith("&");)this.capture("&"),this.parseQueryParam(params);return params},UrlParser.prototype.parseFragment=function(){return this.peekStartsWith("#")?decode(this.remaining.substring(1)):null},UrlParser.prototype.parseMatrixParams=function(){for(var params={};this.remaining.length>0&&this.peekStartsWith(";");)this.capture(";"),this.parseParam(params);return params},UrlParser.prototype.parseParam=function(params){var key=matchSegments(this.remaining);if(key){this.capture(key);var value="true";if(this.peekStartsWith("=")){this.capture("=");var valueMatch=matchSegments(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}params[decode(key)]=decode(value)}},UrlParser.prototype.parseQueryParam=function(params){var key=matchQueryParams(this.remaining);if(key){this.capture(key);var value="";if(this.peekStartsWith("=")){this.capture("=");var valueMatch=matchUrlQueryParamValue(this.remaining);valueMatch&&(value=valueMatch,this.capture(value))}params[decode(key)]=decode(value)}},UrlParser.prototype.parseParens=function(allowPrimary){var segments={};for(this.capture("(");!this.peekStartsWith(")")&&this.remaining.length>0;){var path=matchSegments(this.remaining),next=this.remaining[path.length];if("/"!==next&&")"!==next&&";"!==next)throw new Error("Cannot parse url '"+this.url+"'");var outletName=void 0;path.indexOf(":")>-1?(outletName=path.substr(0,path.indexOf(":")),this.capture(outletName),this.capture(":")):allowPrimary&&(outletName=PRIMARY_OUTLET);var children=this.parseChildren();segments[outletName]=1===Object.keys(children).length?children[PRIMARY_OUTLET]:new UrlSegmentGroup([],children),this.peekStartsWith("//")&&this.capture("//")}return this.capture(")"),segments},UrlParser}(),NoMatch=function(){function NoMatch(segmentGroup){void 0===segmentGroup&&(segmentGroup=null),this.segmentGroup=segmentGroup}return NoMatch}(),AbsoluteRedirect=function(){function AbsoluteRedirect(segments){this.segments=segments}return AbsoluteRedirect}(),ApplyRedirects=function(){function ApplyRedirects(injector,configLoader,urlTree,config){this.injector=injector,this.configLoader=configLoader,this.urlTree=urlTree,this.config=config,this.allowRedirects=!0}return ApplyRedirects.prototype.apply=function(){var _this=this;return this.expandSegmentGroup(this.injector,this.config,this.urlTree.root,PRIMARY_OUTLET).map(function(rootSegmentGroup){return _this.createUrlTree(rootSegmentGroup)}).catch(function(e){if(e instanceof AbsoluteRedirect){_this.allowRedirects=!1;var group=new UrlSegmentGroup([],(_a={},_a[PRIMARY_OUTLET]=new UrlSegmentGroup(e.segments,{}),_a));return _this.match(group)}throw e instanceof NoMatch?_this.noMatchError(e):e;var _a})},ApplyRedirects.prototype.match=function(segmentGroup){var _this=this;return this.expandSegmentGroup(this.injector,this.config,segmentGroup,PRIMARY_OUTLET).map(function(rootSegmentGroup){return _this.createUrlTree(rootSegmentGroup)}).catch(function(e){throw e instanceof NoMatch?_this.noMatchError(e):e})},ApplyRedirects.prototype.noMatchError=function(e){return new Error("Cannot match any routes: '"+e.segmentGroup+"'")},ApplyRedirects.prototype.createUrlTree=function(rootCandidate){var root=rootCandidate.segments.length>0?new UrlSegmentGroup([],(_a={},_a[PRIMARY_OUTLET]=rootCandidate,_a)):rootCandidate;return new UrlTree(root,this.urlTree.queryParams,this.urlTree.fragment);var _a},ApplyRedirects.prototype.expandSegmentGroup=function(injector,routes,segmentGroup,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.expandChildren(injector,routes,segmentGroup).map(function(children){return new UrlSegmentGroup([],children)}):this.expandSegment(injector,segmentGroup,routes,segmentGroup.segments,outlet,!0)},ApplyRedirects.prototype.expandChildren=function(injector,routes,segmentGroup){var _this=this;return waitForMap(segmentGroup.children,function(childOutlet,child){return _this.expandSegmentGroup(injector,routes,child,childOutlet)})},ApplyRedirects.prototype.expandSegment=function(injector,segmentGroup,routes,segments,outlet,allowRedirects){var _this=this,processRoutes=rxjs_observable_of.of.apply(rxjs_observable_of,routes).map(function(r){return _this.expandSegmentAgainstRoute(injector,segmentGroup,routes,r,segments,outlet,allowRedirects).catch(function(e){if(e instanceof NoMatch)return rxjs_observable_of.of(null);throw e})}).concatAll();return processRoutes.first(function(s){return!!s}).catch(function(e,_){throw e instanceof rxjs_util_EmptyError.EmptyError?new NoMatch(segmentGroup):e})},ApplyRedirects.prototype.expandSegmentAgainstRoute=function(injector,segmentGroup,routes,route,paths,outlet,allowRedirects){return getOutlet$1(route)!==outlet?noMatch(segmentGroup):void 0===route.redirectTo||allowRedirects&&this.allowRedirects?void 0===route.redirectTo?this.matchSegmentAgainstRoute(injector,segmentGroup,route,paths):this.expandSegmentAgainstRouteUsingRedirect(injector,segmentGroup,routes,route,paths,outlet):noMatch(segmentGroup)},ApplyRedirects.prototype.expandSegmentAgainstRouteUsingRedirect=function(injector,segmentGroup,routes,route,segments,outlet){return"**"===route.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(route):this.expandRegularSegmentAgainstRouteUsingRedirect(injector,segmentGroup,routes,route,segments,outlet)},ApplyRedirects.prototype.expandWildCardWithParamsAgainstRouteUsingRedirect=function(route){var newSegments=applyRedirectCommands([],route.redirectTo,{});return route.redirectTo.startsWith("/")?absoluteRedirect(newSegments):rxjs_observable_of.of(new UrlSegmentGroup(newSegments,{}))},ApplyRedirects.prototype.expandRegularSegmentAgainstRouteUsingRedirect=function(injector,segmentGroup,routes,route,segments,outlet){var _a=match(segmentGroup,route,segments),matched=_a.matched,consumedSegments=_a.consumedSegments,lastChild=_a.lastChild,positionalParamSegments=_a.positionalParamSegments;if(!matched)return noMatch(segmentGroup);var newSegments=applyRedirectCommands(consumedSegments,route.redirectTo,positionalParamSegments);return route.redirectTo.startsWith("/")?absoluteRedirect(newSegments):this.expandSegment(injector,segmentGroup,routes,newSegments.concat(segments.slice(lastChild)),outlet,!1)},ApplyRedirects.prototype.matchSegmentAgainstRoute=function(injector,rawSegmentGroup,route,segments){var _this=this;if("**"===route.path)return rxjs_observable_of.of(new UrlSegmentGroup(segments,{}));var _a=match(rawSegmentGroup,route,segments),matched=_a.matched,consumedSegments_1=_a.consumedSegments,lastChild=_a.lastChild;if(!matched)return noMatch(rawSegmentGroup);var rawSlicedSegments_1=segments.slice(lastChild);return this.getChildConfig(injector,route).mergeMap(function(routerConfig){var childInjector=routerConfig.injector,childConfig=routerConfig.routes,_a=split(rawSegmentGroup,consumedSegments_1,rawSlicedSegments_1,childConfig),segmentGroup=_a.segmentGroup,slicedSegments=_a.slicedSegments;return 0===slicedSegments.length&&segmentGroup.hasChildren()?_this.expandChildren(childInjector,childConfig,segmentGroup).map(function(children){return new UrlSegmentGroup(consumedSegments_1,children)}):0===childConfig.length&&0===slicedSegments.length?rxjs_observable_of.of(new UrlSegmentGroup(consumedSegments_1,{})):_this.expandSegment(childInjector,segmentGroup,childConfig,slicedSegments,PRIMARY_OUTLET,!0).map(function(cs){return new UrlSegmentGroup(consumedSegments_1.concat(cs.segments),cs.children)})})},ApplyRedirects.prototype.getChildConfig=function(injector,route){var _this=this;return route.children?rxjs_observable_of.of(new LoadedRouterConfig(route.children,injector,null)):route.loadChildren?runGuards(injector,route).mergeMap(function(shouldLoad){return shouldLoad?_this.configLoader.load(injector,route.loadChildren).map(function(r){return route._loadedConfig=r,r}):canLoadFails(route)}):rxjs_observable_of.of(new LoadedRouterConfig([],injector,null))},ApplyRedirects}(),Tree=function(){function Tree(root){this._root=root}return Object.defineProperty(Tree.prototype,"root",{get:function(){return this._root.value},enumerable:!0,configurable:!0}),Tree.prototype.parent=function(t){var p=this.pathFromRoot(t);return p.length>1?p[p.length-2]:null},Tree.prototype.children=function(t){var n=findNode(t,this._root);return n?n.children.map(function(t){return t.value}):[]},Tree.prototype.firstChild=function(t){var n=findNode(t,this._root);return n&&n.children.length>0?n.children[0].value:null},Tree.prototype.siblings=function(t){var p=findPath(t,this._root,[]);if(p.length<2)return[];var c=p[p.length-2].children.map(function(c){return c.value});return c.filter(function(cc){return cc!==t})},Tree.prototype.pathFromRoot=function(t){return findPath(t,this._root,[]).map(function(s){return s.value})},Tree}(),TreeNode=function(){function TreeNode(value,children){this.value=value,this.children=children}return TreeNode.prototype.toString=function(){return"TreeNode("+this.value+")"},TreeNode}(),RouterState=function(_super){function RouterState(root,snapshot){_super.call(this,root),this.snapshot=snapshot,setRouterStateSnapshot(this,root)}return __extends(RouterState,_super),Object.defineProperty(RouterState.prototype,"queryParams",{get:function(){return this.root.queryParams},enumerable:!0,configurable:!0}),Object.defineProperty(RouterState.prototype,"fragment",{get:function(){return this.root.fragment},enumerable:!0,configurable:!0}),RouterState.prototype.toString=function(){return this.snapshot.toString()},RouterState}(Tree),ActivatedRoute=function(){function ActivatedRoute(url,params,queryParams,fragment,data,outlet,component,futureSnapshot){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this._futureSnapshot=futureSnapshot}return Object.defineProperty(ActivatedRoute.prototype,"routeConfig",{get:function(){return this._futureSnapshot.routeConfig},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRoute.prototype,"root",{get:function(){return this._routerState.root},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRoute.prototype,"parent",{get:function(){return this._routerState.parent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRoute.prototype,"firstChild",{get:function(){return this._routerState.firstChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRoute.prototype,"children",{get:function(){return this._routerState.children(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRoute.prototype,"pathFromRoot",{get:function(){return this._routerState.pathFromRoot(this)},enumerable:!0,configurable:!0}),ActivatedRoute.prototype.toString=function(){return this.snapshot?this.snapshot.toString():"Future("+this._futureSnapshot+")"},ActivatedRoute}(),InheritedResolve=function(){function InheritedResolve(parent,current){this.parent=parent,this.current=current,this.resolvedData={}}return Object.defineProperty(InheritedResolve.prototype,"flattenedResolvedData",{get:function(){return this.parent?merge(this.parent.flattenedResolvedData,this.resolvedData):this.resolvedData},enumerable:!0,configurable:!0}),Object.defineProperty(InheritedResolve,"empty",{get:function(){return new InheritedResolve(null,{})},enumerable:!0,configurable:!0}),InheritedResolve}(),ActivatedRouteSnapshot=function(){function ActivatedRouteSnapshot(url,params,queryParams,fragment,data,outlet,component,routeConfig,urlSegment,lastPathIndex,resolve){this.url=url,this.params=params,this.queryParams=queryParams,this.fragment=fragment,this.data=data,this.outlet=outlet,this.component=component,this._routeConfig=routeConfig,this._urlSegment=urlSegment,this._lastPathIndex=lastPathIndex,this._resolve=resolve}return Object.defineProperty(ActivatedRouteSnapshot.prototype,"routeConfig",{get:function(){return this._routeConfig},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRouteSnapshot.prototype,"root",{get:function(){return this._routerState.root},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRouteSnapshot.prototype,"parent",{get:function(){return this._routerState.parent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRouteSnapshot.prototype,"firstChild",{get:function(){return this._routerState.firstChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRouteSnapshot.prototype,"children",{get:function(){return this._routerState.children(this)},enumerable:!0,configurable:!0}),Object.defineProperty(ActivatedRouteSnapshot.prototype,"pathFromRoot",{get:function(){return this._routerState.pathFromRoot(this)},enumerable:!0,configurable:!0}),ActivatedRouteSnapshot.prototype.toString=function(){var url=this.url.map(function(s){return s.toString()}).join("/"),matched=this._routeConfig?this._routeConfig.path:"";return"Route(url:'"+url+"', path:'"+matched+"')"},ActivatedRouteSnapshot}(),RouterStateSnapshot=function(_super){function RouterStateSnapshot(url,root){_super.call(this,root),this.url=url,setRouterStateSnapshot(this,root)}return __extends(RouterStateSnapshot,_super),Object.defineProperty(RouterStateSnapshot.prototype,"queryParams",{get:function(){return this.root.queryParams},enumerable:!0,configurable:!0}),Object.defineProperty(RouterStateSnapshot.prototype,"fragment",{get:function(){return this.root.fragment},enumerable:!0,configurable:!0}),RouterStateSnapshot.prototype.toString=function(){return serializeNode(this._root)},RouterStateSnapshot}(Tree),NormalizedNavigationCommands=function(){function NormalizedNavigationCommands(isAbsolute,numberOfDoubleDots,commands){this.isAbsolute=isAbsolute,this.numberOfDoubleDots=numberOfDoubleDots,this.commands=commands}return NormalizedNavigationCommands}(),Position=function(){function Position(segmentGroup,processChildren,index){this.segmentGroup=segmentGroup,this.processChildren=processChildren,this.index=index}return Position}(),NoMatch$1=function(){function NoMatch$1(){}return NoMatch$1}(),InheritedFromParent=function(){function InheritedFromParent(parent,snapshot,params,data,resolve){this.parent=parent,this.snapshot=snapshot,this.params=params,this.data=data,this.resolve=resolve}return Object.defineProperty(InheritedFromParent.prototype,"allParams",{get:function(){return this.parent?merge(this.parent.allParams,this.params):this.params},enumerable:!0,configurable:!0}),Object.defineProperty(InheritedFromParent.prototype,"allData",{get:function(){return this.parent?merge(this.parent.allData,this.data):this.data},enumerable:!0,configurable:!0}),InheritedFromParent.empty=function(snapshot){return new InheritedFromParent(null,snapshot,{},{},new InheritedResolve(null,{}))},InheritedFromParent}(),Recognizer=function(){function Recognizer(rootComponentType,config,urlTree,url){this.rootComponentType=rootComponentType,this.config=config,this.urlTree=urlTree,this.url=url}return Recognizer.prototype.recognize=function(){try{var rootSegmentGroup=split$1(this.urlTree.root,[],[],this.config).segmentGroup,children=this.processSegmentGroup(this.config,rootSegmentGroup,InheritedFromParent.empty(null),PRIMARY_OUTLET),root=new ActivatedRouteSnapshot([],Object.freeze({}),Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,{},PRIMARY_OUTLET,this.rootComponentType,null,this.urlTree.root,(-1),InheritedResolve.empty),rootNode=new TreeNode(root,children);return rxjs_observable_of.of(new RouterStateSnapshot(this.url,rootNode))}catch(e){return new rxjs_Observable.Observable(function(obs){return obs.error(e)})}},Recognizer.prototype.processSegmentGroup=function(config,segmentGroup,inherited,outlet){return 0===segmentGroup.segments.length&&segmentGroup.hasChildren()?this.processChildren(config,segmentGroup,inherited):this.processSegment(config,segmentGroup,0,segmentGroup.segments,inherited,outlet)},Recognizer.prototype.processChildren=function(config,segmentGroup,inherited){var _this=this,children=mapChildrenIntoArray(segmentGroup,function(child,childOutlet){return _this.processSegmentGroup(config,child,inherited,childOutlet)});return checkOutletNameUniqueness(children),sortActivatedRouteSnapshots(children),children},Recognizer.prototype.processSegment=function(config,segmentGroup,pathIndex,segments,inherited,outlet){for(var _i=0,config_1=config;_i<config_1.length;_i++){var r=config_1[_i];try{return this.processSegmentAgainstRoute(r,segmentGroup,pathIndex,segments,inherited,outlet)}catch(e){if(!(e instanceof NoMatch$1))throw e}}throw new NoMatch$1},Recognizer.prototype.processSegmentAgainstRoute=function(route,rawSegment,pathIndex,segments,inherited,outlet){if(route.redirectTo)throw new NoMatch$1;if((route.outlet?route.outlet:PRIMARY_OUTLET)!==outlet)throw new NoMatch$1;var newInheritedResolve=new InheritedResolve(inherited.resolve,getResolve(route));if("**"===route.path){var params=segments.length>0?last(segments).parameters:{},snapshot_1=new ActivatedRouteSnapshot(segments,Object.freeze(merge(inherited.allParams,params)),Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,merge(inherited.allData,getData(route)),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+segments.length,newInheritedResolve);return[new TreeNode(snapshot_1,[])]}var _a=match$1(rawSegment,route,segments,inherited.snapshot),consumedSegments=_a.consumedSegments,parameters=_a.parameters,lastChild=_a.lastChild,rawSlicedSegments=segments.slice(lastChild),childConfig=getChildConfig(route),_b=split$1(rawSegment,consumedSegments,rawSlicedSegments,childConfig),segmentGroup=_b.segmentGroup,slicedSegments=_b.slicedSegments,snapshot=new ActivatedRouteSnapshot(consumedSegments,Object.freeze(merge(inherited.allParams,parameters)),Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,merge(inherited.allData,getData(route)),outlet,route.component,route,getSourceSegmentGroup(rawSegment),getPathIndexShift(rawSegment)+consumedSegments.length,newInheritedResolve),newInherited=route.component?InheritedFromParent.empty(snapshot):new InheritedFromParent(inherited,snapshot,parameters,getData(route),newInheritedResolve);if(0===slicedSegments.length&&segmentGroup.hasChildren()){var children=this.processChildren(childConfig,segmentGroup,newInherited);return[new TreeNode(snapshot,children)]}if(0===childConfig.length&&0===slicedSegments.length)return[new TreeNode(snapshot,[])];var children=this.processSegment(childConfig,segmentGroup,pathIndex+lastChild,slicedSegments,newInherited,PRIMARY_OUTLET);return[new TreeNode(snapshot,children)]},Recognizer}(),RouterOutletMap=function(){function RouterOutletMap(){this._outlets={}}return RouterOutletMap.prototype.registerOutlet=function(name,outlet){this._outlets[name]=outlet},RouterOutletMap.prototype.removeOutlet=function(name){this._outlets[name]=void 0},RouterOutletMap}(),NavigationStart=function(){function NavigationStart(id,url){this.id=id,this.url=url}return NavigationStart.prototype.toString=function(){return"NavigationStart(id: "+this.id+", url: '"+this.url+"')"},NavigationStart}(),NavigationEnd=function(){function NavigationEnd(id,url,urlAfterRedirects){this.id=id,this.url=url,this.urlAfterRedirects=urlAfterRedirects}return NavigationEnd.prototype.toString=function(){return"NavigationEnd(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"')"},NavigationEnd}(),NavigationCancel=function(){function NavigationCancel(id,url){this.id=id,this.url=url}return NavigationCancel.prototype.toString=function(){return"NavigationCancel(id: "+this.id+", url: '"+this.url+"')"},NavigationCancel}(),NavigationError=function(){function NavigationError(id,url,error){this.id=id,this.url=url,this.error=error}return NavigationError.prototype.toString=function(){return"NavigationError(id: "+this.id+", url: '"+this.url+"', error: "+this.error+")"},NavigationError}(),RoutesRecognized=function(){function RoutesRecognized(id,url,urlAfterRedirects,state){this.id=id,this.url=url,this.urlAfterRedirects=urlAfterRedirects,this.state=state}return RoutesRecognized.prototype.toString=function(){return"RoutesRecognized(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+")"},RoutesRecognized}(),Router=function(){function Router(rootComponentType,resolver,urlSerializer,outletMap,location,injector,loader,config){this.rootComponentType=rootComponentType,this.resolver=resolver,this.urlSerializer=urlSerializer,this.outletMap=outletMap,this.location=location,this.injector=injector,this.navigationId=0,this.navigated=!1,this.resetConfig(config),this.routerEvents=new rxjs_Subject.Subject,this.currentUrlTree=createEmptyUrlTree(),this.configLoader=new RouterConfigLoader(loader),this.currentRouterState=createEmptyState(this.currentUrlTree,this.rootComponentType)}return Router.prototype.initialNavigation=function(){this.setUpLocationChangeListener(),this.navigateByUrl(this.location.path(!0))},Object.defineProperty(Router.prototype,"routerState",{get:function(){return this.currentRouterState},enumerable:!0,configurable:!0}),Object.defineProperty(Router.prototype,"url",{get:function(){return this.serializeUrl(this.currentUrlTree)},enumerable:!0,configurable:!0}),Object.defineProperty(Router.prototype,"events",{get:function(){return this.routerEvents},enumerable:!0,configurable:!0}),Router.prototype.resetConfig=function(config){validateConfig(config),this.config=config},Router.prototype.ngOnDestroy=function(){this.dispose()},Router.prototype.dispose=function(){this.locationSubscription.unsubscribe()},Router.prototype.createUrlTree=function(commands,_a){var _b=void 0===_a?{}:_a,relativeTo=_b.relativeTo,queryParams=_b.queryParams,fragment=_b.fragment,preserveQueryParams=_b.preserveQueryParams,preserveFragment=_b.preserveFragment,a=relativeTo?relativeTo:this.routerState.root,q=preserveQueryParams?this.currentUrlTree.queryParams:queryParams,f=preserveFragment?this.currentUrlTree.fragment:fragment;return createUrlTree(a,this.currentUrlTree,commands,q,f)},Router.prototype.navigateByUrl=function(url,extras){if(void 0===extras&&(extras={skipLocationChange:!1}),url instanceof UrlTree)return this.scheduleNavigation(url,extras);var urlTree=this.urlSerializer.parse(url);return this.scheduleNavigation(urlTree,extras)},Router.prototype.navigate=function(commands,extras){return void 0===extras&&(extras={skipLocationChange:!1}),this.scheduleNavigation(this.createUrlTree(commands,extras),extras)},Router.prototype.serializeUrl=function(url){return this.urlSerializer.serialize(url)},Router.prototype.parseUrl=function(url){return this.urlSerializer.parse(url)},Router.prototype.isActive=function(url,exact){if(url instanceof UrlTree)return containsTree(this.currentUrlTree,url,exact);var urlTree=this.urlSerializer.parse(url);return containsTree(this.currentUrlTree,urlTree,exact)},Router.prototype.scheduleNavigation=function(url,extras){var _this=this,id=++this.navigationId;return this.routerEvents.next(new NavigationStart(id,this.serializeUrl(url))),Promise.resolve().then(function(_){return _this.runNavigate(url,extras.skipLocationChange,id)})},Router.prototype.setUpLocationChangeListener=function(){var _this=this;this.locationSubscription=this.location.subscribe(Zone.current.wrap(function(change){var tree=_this.urlSerializer.parse(change.url);return _this.currentUrlTree.toString()!==tree.toString()?_this.scheduleNavigation(tree,change.pop):null}))},Router.prototype.runNavigate=function(url,preventPushState,id){var _this=this;return id!==this.navigationId?(this.location.go(this.urlSerializer.serialize(this.currentUrlTree)),this.routerEvents.next(new NavigationCancel(id,this.serializeUrl(url))),Promise.resolve(!1)):new Promise(function(resolvePromise,rejectPromise){var state,navigationIsSuccessful,preActivation,appliedUrl,storedState=_this.currentRouterState,storedUrl=_this.currentUrlTree;applyRedirects(_this.injector,_this.configLoader,url,_this.config).mergeMap(function(u){return appliedUrl=u,recognize(_this.rootComponentType,_this.config,appliedUrl,_this.serializeUrl(appliedUrl))}).mergeMap(function(newRouterStateSnapshot){return _this.routerEvents.next(new RoutesRecognized(id,_this.serializeUrl(url),_this.serializeUrl(appliedUrl),newRouterStateSnapshot)),resolve(_this.resolver,newRouterStateSnapshot)}).map(function(routerStateSnapshot){return createRouterState(routerStateSnapshot,_this.currentRouterState)}).map(function(newState){state=newState,preActivation=new PreActivation(state.snapshot,_this.currentRouterState.snapshot,_this.injector),preActivation.traverse(_this.outletMap)}).mergeMap(function(_){return preActivation.checkGuards()}).mergeMap(function(shouldActivate){return shouldActivate?preActivation.resolveData().map(function(){return shouldActivate}):rxjs_observable_of.of(shouldActivate)}).forEach(function(shouldActivate){if(!shouldActivate||id!==_this.navigationId)return _this.routerEvents.next(new NavigationCancel(id,_this.serializeUrl(url))),void(navigationIsSuccessful=!1);if(_this.currentUrlTree=appliedUrl,_this.currentRouterState=state,new ActivateRoutes(state,storedState).activate(_this.outletMap),!preventPushState){var path=_this.urlSerializer.serialize(appliedUrl);_this.location.isCurrentPathEqualTo(path)?_this.location.replaceState(path):_this.location.go(path)}navigationIsSuccessful=!0}).then(function(){_this.navigated=!0,_this.routerEvents.next(new NavigationEnd(id,_this.serializeUrl(url),_this.serializeUrl(appliedUrl))),resolvePromise(navigationIsSuccessful)},function(e){_this.currentRouterState=storedState,_this.currentUrlTree=storedUrl,_this.routerEvents.next(new NavigationError(id,_this.serializeUrl(url),e)),rejectPromise(e)})})},Router}(),CanActivate=function(){function CanActivate(path){this.path=path}return Object.defineProperty(CanActivate.prototype,"route",{get:function(){return this.path[this.path.length-1]},enumerable:!0,configurable:!0}),CanActivate}(),CanDeactivate=function(){function CanDeactivate(component,route){this.component=component,this.route=route}return CanDeactivate}(),PreActivation=function(){function PreActivation(future,curr,injector){this.future=future,this.curr=curr,this.injector=injector,this.checks=[]}return PreActivation.prototype.traverse=function(parentOutletMap){
var futureRoot=this.future._root,currRoot=this.curr?this.curr._root:null;this.traverseChildRoutes(futureRoot,currRoot,parentOutletMap,[futureRoot.value])},PreActivation.prototype.checkGuards=function(){var _this=this;return 0===this.checks.length?rxjs_observable_of.of(!0):rxjs_observable_from.from(this.checks).map(function(s){if(s instanceof CanActivate)return andObservables(rxjs_observable_from.from([_this.runCanActivate(s.route),_this.runCanActivateChild(s.path)]));if(s instanceof CanDeactivate){var s2=s;return _this.runCanDeactivate(s2.component,s2.route)}throw new Error("Cannot be reached")}).mergeAll().every(function(result){return result===!0})},PreActivation.prototype.resolveData=function(){var _this=this;return 0===this.checks.length?rxjs_observable_of.of(null):rxjs_observable_from.from(this.checks).mergeMap(function(s){return s instanceof CanActivate?_this.runResolve(s.route):rxjs_observable_of.of(null)}).reduce(function(_,__){return _})},PreActivation.prototype.traverseChildRoutes=function(futureNode,currNode,outletMap,futurePath){var _this=this,prevChildren=nodeChildrenAsMap(currNode);futureNode.children.forEach(function(c){_this.traverseRoutes(c,prevChildren[c.value.outlet],outletMap,futurePath.concat([c.value])),delete prevChildren[c.value.outlet]}),forEach(prevChildren,function(v,k){return _this.deactivateOutletAndItChildren(v,outletMap._outlets[k])})},PreActivation.prototype.traverseRoutes=function(futureNode,currNode,parentOutletMap,futurePath){var future=futureNode.value,curr=currNode?currNode.value:null,outlet=parentOutletMap?parentOutletMap._outlets[futureNode.value.outlet]:null;curr&&future._routeConfig===curr._routeConfig?(shallowEqual(future.params,curr.params)||this.checks.push(new CanDeactivate(outlet.component,curr),new CanActivate(futurePath)),future.component?this.traverseChildRoutes(futureNode,currNode,outlet?outlet.outletMap:null,futurePath):this.traverseChildRoutes(futureNode,currNode,parentOutletMap,futurePath)):(curr&&(curr.component?this.deactivateOutletAndItChildren(curr,outlet):this.deactivateOutletMap(parentOutletMap)),this.checks.push(new CanActivate(futurePath)),future.component?this.traverseChildRoutes(futureNode,null,outlet?outlet.outletMap:null,futurePath):this.traverseChildRoutes(futureNode,null,parentOutletMap,futurePath))},PreActivation.prototype.deactivateOutletAndItChildren=function(route,outlet){outlet&&outlet.isActivated&&(this.deactivateOutletMap(outlet.outletMap),this.checks.push(new CanDeactivate(outlet.component,route)))},PreActivation.prototype.deactivateOutletMap=function(outletMap){var _this=this;forEach(outletMap._outlets,function(v){v.isActivated&&_this.deactivateOutletAndItChildren(v.activatedRoute.snapshot,v)})},PreActivation.prototype.runCanActivate=function(future){var _this=this,canActivate=future._routeConfig?future._routeConfig.canActivate:null;if(!canActivate||0===canActivate.length)return rxjs_observable_of.of(!0);var obs=rxjs_observable_from.from(canActivate).map(function(c){var guard=_this.getToken(c,future,_this.future);return wrapIntoObservable(guard.canActivate?guard.canActivate(future,_this.future):guard(future,_this.future))});return andObservables(obs)},PreActivation.prototype.runCanActivateChild=function(path){var _this=this,future=path[path.length-1],canActivateChildGuards=path.slice(0,path.length-1).reverse().map(function(p){return _this.extractCanActivateChild(p)}).filter(function(_){return null!==_});return andObservables(rxjs_observable_from.from(canActivateChildGuards).map(function(d){var obs=rxjs_observable_from.from(d.guards).map(function(c){var guard=_this.getToken(c,c.node,_this.future);return wrapIntoObservable(guard.canActivateChild?guard.canActivateChild(future,_this.future):guard(future,_this.future))});return andObservables(obs)}))},PreActivation.prototype.extractCanActivateChild=function(p){var canActivateChild=p._routeConfig?p._routeConfig.canActivateChild:null;return canActivateChild&&0!==canActivateChild.length?{node:p,guards:canActivateChild}:null},PreActivation.prototype.runCanDeactivate=function(component,curr){var _this=this,canDeactivate=curr&&curr._routeConfig?curr._routeConfig.canDeactivate:null;return canDeactivate&&0!==canDeactivate.length?rxjs_observable_from.from(canDeactivate).map(function(c){var guard=_this.getToken(c,curr,_this.curr);return wrapIntoObservable(guard.canDeactivate?guard.canDeactivate(component,curr,_this.curr):guard(component,curr,_this.curr))}).mergeAll().every(function(result){return result===!0}):rxjs_observable_of.of(!0)},PreActivation.prototype.runResolve=function(future){var resolve=future._resolve;return this.resolveNode(resolve.current,future).map(function(resolvedData){return resolve.resolvedData=resolvedData,future.data=merge(future.data,resolve.flattenedResolvedData),null})},PreActivation.prototype.resolveNode=function(resolve,future){var _this=this;return waitForMap(resolve,function(k,v){var resolver=_this.getToken(v,future,_this.future);return wrapIntoObservable(resolver.resolve?resolver.resolve(future,_this.future):resolver(future,_this.future))})},PreActivation.prototype.getToken=function(token,snapshot,state){var config=closestLoadedConfig(state,snapshot),injector=config?config.injector:this.injector;return injector.get(token)},PreActivation}(),ActivateRoutes=function(){function ActivateRoutes(futureState,currState){this.futureState=futureState,this.currState=currState}return ActivateRoutes.prototype.activate=function(parentOutletMap){var futureRoot=this.futureState._root,currRoot=this.currState?this.currState._root:null;advanceActivatedRoute(this.futureState.root),this.activateChildRoutes(futureRoot,currRoot,parentOutletMap)},ActivateRoutes.prototype.activateChildRoutes=function(futureNode,currNode,outletMap){var _this=this,prevChildren=nodeChildrenAsMap(currNode);futureNode.children.forEach(function(c){_this.activateRoutes(c,prevChildren[c.value.outlet],outletMap),delete prevChildren[c.value.outlet]}),forEach(prevChildren,function(v,k){return _this.deactivateOutletAndItChildren(outletMap._outlets[k])})},ActivateRoutes.prototype.activateRoutes=function(futureNode,currNode,parentOutletMap){var future=futureNode.value,curr=currNode?currNode.value:null;if(future===curr)if(advanceActivatedRoute(future),future.component){var outlet=getOutlet(parentOutletMap,futureNode.value);this.activateChildRoutes(futureNode,currNode,outlet.outletMap)}else this.activateChildRoutes(futureNode,currNode,parentOutletMap);else{if(curr)if(curr.component){var outlet=getOutlet(parentOutletMap,futureNode.value);this.deactivateOutletAndItChildren(outlet)}else this.deactivateOutletMap(parentOutletMap);if(future.component){advanceActivatedRoute(future);var outlet=getOutlet(parentOutletMap,futureNode.value),outletMap=new RouterOutletMap;this.placeComponentIntoOutlet(outletMap,future,outlet),this.activateChildRoutes(futureNode,null,outletMap)}else advanceActivatedRoute(future),this.activateChildRoutes(futureNode,null,parentOutletMap)}},ActivateRoutes.prototype.placeComponentIntoOutlet=function(outletMap,future,outlet){var resolved=[{provide:ActivatedRoute,useValue:future},{provide:RouterOutletMap,useValue:outletMap}],config=closestLoadedConfig(this.futureState.snapshot,future.snapshot),loadedFactoryResolver=null,loadedInjector=null;config&&(loadedFactoryResolver=config.factoryResolver,loadedInjector=config.injector,resolved.push({provide:_angular_core.ComponentFactoryResolver,useValue:loadedFactoryResolver})),outlet.activate(future,loadedFactoryResolver,loadedInjector,_angular_core.ReflectiveInjector.resolve(resolved),outletMap)},ActivateRoutes.prototype.deactivateOutletAndItChildren=function(outlet){outlet&&outlet.isActivated&&(this.deactivateOutletMap(outlet.outletMap),outlet.deactivate())},ActivateRoutes.prototype.deactivateOutletMap=function(outletMap){var _this=this;forEach(outletMap._outlets,function(v){return _this.deactivateOutletAndItChildren(v)})},ActivateRoutes}(),ROUTER_CONFIGURATION=new _angular_core.OpaqueToken("ROUTER_CONFIGURATION"),RouterLink=function(){function RouterLink(router,route,locationStrategy){this.router=router,this.route=route,this.locationStrategy=locationStrategy,this.commands=[]}return Object.defineProperty(RouterLink.prototype,"routerLink",{set:function(data){Array.isArray(data)?this.commands=data:this.commands=[data]},enumerable:!0,configurable:!0}),RouterLink.prototype.onClick=function(button,ctrlKey,metaKey){return!(0===button&&!ctrlKey&&!metaKey)||(this.router.navigateByUrl(this.urlTree),!1)},Object.defineProperty(RouterLink.prototype,"urlTree",{get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:toBool(this.preserveQueryParams),preserveFragment:toBool(this.preserveFragment)})},enumerable:!0,configurable:!0}),RouterLink}();RouterLink.decorators=[{type:_angular_core.Directive,args:[{selector:":not(a)[routerLink]"}]}],RouterLink.ctorParameters=[{type:Router},{type:ActivatedRoute},{type:_angular_common.LocationStrategy}],RouterLink.propDecorators={queryParams:[{type:_angular_core.Input}],fragment:[{type:_angular_core.Input}],preserveQueryParams:[{type:_angular_core.Input}],preserveFragment:[{type:_angular_core.Input}],routerLink:[{type:_angular_core.Input}],onClick:[{type:_angular_core.HostListener,args:["click",["$event.button","$event.ctrlKey","$event.metaKey"]]}]};var RouterLinkWithHref=function(){function RouterLinkWithHref(router,route,locationStrategy){var _this=this;this.router=router,this.route=route,this.locationStrategy=locationStrategy,this.commands=[],this.subscription=router.events.subscribe(function(s){s instanceof NavigationEnd&&_this.updateTargetUrlAndHref()})}return Object.defineProperty(RouterLinkWithHref.prototype,"routerLink",{set:function(data){Array.isArray(data)?this.commands=data:this.commands=[data]},enumerable:!0,configurable:!0}),RouterLinkWithHref.prototype.ngOnChanges=function(changes){this.updateTargetUrlAndHref()},RouterLinkWithHref.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},RouterLinkWithHref.prototype.onClick=function(button,ctrlKey,metaKey){return!(0===button&&!ctrlKey&&!metaKey)||("string"==typeof this.target&&"_self"!=this.target||(this.router.navigateByUrl(this.urlTree),!1))},RouterLinkWithHref.prototype.updateTargetUrlAndHref=function(){this.urlTree=this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:toBool(this.preserveQueryParams),preserveFragment:toBool(this.preserveFragment)}),this.urlTree&&(this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)))},RouterLinkWithHref}();RouterLinkWithHref.decorators=[{type:_angular_core.Directive,args:[{selector:"a[routerLink]"}]}],RouterLinkWithHref.ctorParameters=[{type:Router},{type:ActivatedRoute},{type:_angular_common.LocationStrategy}],RouterLinkWithHref.propDecorators={target:[{type:_angular_core.Input}],queryParams:[{type:_angular_core.Input}],fragment:[{type:_angular_core.Input}],routerLinkOptions:[{type:_angular_core.Input}],preserveQueryParams:[{type:_angular_core.Input}],preserveFragment:[{type:_angular_core.Input}],href:[{type:_angular_core.HostBinding}],routerLink:[{type:_angular_core.Input}],onClick:[{type:_angular_core.HostListener,args:["click",["$event.button","$event.ctrlKey","$event.metaKey"]]}]};var RouterLinkActive=function(){function RouterLinkActive(router,element,renderer){var _this=this;this.router=router,this.element=element,this.renderer=renderer,this.classes=[],this.routerLinkActiveOptions={exact:!1},this.subscription=router.events.subscribe(function(s){s instanceof NavigationEnd&&_this.update()})}return RouterLinkActive.prototype.ngAfterContentInit=function(){var _this=this;this.links.changes.subscribe(function(s){return _this.update()}),this.linksWithHrefs.changes.subscribe(function(s){return _this.update()}),this.update()},Object.defineProperty(RouterLinkActive.prototype,"routerLinkActive",{set:function(data){Array.isArray(data)?this.classes=data:this.classes=data.split(" ")},enumerable:!0,configurable:!0}),RouterLinkActive.prototype.ngOnChanges=function(changes){this.update()},RouterLinkActive.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},RouterLinkActive.prototype.update=function(){var _this=this;if(this.links&&this.linksWithHrefs&&this.router.navigated){var isActiveLinks=this.reduceList(this.links),isActiveLinksWithHrefs=this.reduceList(this.linksWithHrefs);this.classes.forEach(function(c){return _this.renderer.setElementClass(_this.element.nativeElement,c,isActiveLinks||isActiveLinksWithHrefs)})}},RouterLinkActive.prototype.reduceList=function(q){var _this=this;return q.reduce(function(res,link){return res||_this.router.isActive(link.urlTree,_this.routerLinkActiveOptions.exact)},!1)},RouterLinkActive}();RouterLinkActive.decorators=[{type:_angular_core.Directive,args:[{selector:"[routerLinkActive]"}]}],RouterLinkActive.ctorParameters=[{type:Router},{type:_angular_core.ElementRef},{type:_angular_core.Renderer}],RouterLinkActive.propDecorators={links:[{type:_angular_core.ContentChildren,args:[RouterLink,{descendants:!0}]}],linksWithHrefs:[{type:_angular_core.ContentChildren,args:[RouterLinkWithHref,{descendants:!0}]}],routerLinkActiveOptions:[{type:_angular_core.Input}],routerLinkActive:[{type:_angular_core.Input}]};var RouterOutlet=function(){function RouterOutlet(parentOutletMap,location,resolver,name){this.parentOutletMap=parentOutletMap,this.location=location,this.resolver=resolver,this.name=name,this.activateEvents=new _angular_core.EventEmitter,this.deactivateEvents=new _angular_core.EventEmitter,parentOutletMap.registerOutlet(name?name:PRIMARY_OUTLET,this)}return RouterOutlet.prototype.ngOnDestroy=function(){this.parentOutletMap.removeOutlet(this.name?this.name:PRIMARY_OUTLET)},Object.defineProperty(RouterOutlet.prototype,"isActivated",{get:function(){return!!this.activated},enumerable:!0,configurable:!0}),Object.defineProperty(RouterOutlet.prototype,"component",{get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance},enumerable:!0,configurable:!0}),Object.defineProperty(RouterOutlet.prototype,"activatedRoute",{get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute},enumerable:!0,configurable:!0}),RouterOutlet.prototype.deactivate=function(){if(this.activated){var c=this.component;this.activated.destroy(),this.activated=null,this.deactivateEvents.emit(c)}},RouterOutlet.prototype.activate=function(activatedRoute,loadedResolver,loadedInjector,providers,outletMap){this.outletMap=outletMap,this._activatedRoute=activatedRoute;var factory,snapshot=activatedRoute._futureSnapshot,component=snapshot._routeConfig.component;try{factory="string"==typeof component?snapshot._resolvedComponentFactory:loadedResolver?loadedResolver.resolveComponentFactory(component):this.resolver.resolveComponentFactory(component)}catch(e){if(!(e instanceof _angular_core.NoComponentFactoryError))throw e;var componentName=component?component.name:null;console.warn("'"+componentName+"' not found in entryComponents array.  To ensure all components referred\n          to by the Routes are compiled, you must add '"+componentName+"' to the\n          'entryComponents' array of your application component. This will be required in a future\n          release of the router."),factory=snapshot._resolvedComponentFactory}var injector=loadedInjector?loadedInjector:this.location.parentInjector,inj=_angular_core.ReflectiveInjector.fromResolvedProviders(providers,injector);this.activated=this.location.createComponent(factory,this.location.length,inj,[]),this.activated.changeDetectorRef.detectChanges(),this.activateEvents.emit(this.activated.instance)},RouterOutlet}();RouterOutlet.decorators=[{type:_angular_core.Directive,args:[{selector:"router-outlet"}]}],RouterOutlet.ctorParameters=[{type:RouterOutletMap},{type:_angular_core.ViewContainerRef},{type:_angular_core.ComponentFactoryResolver},{type:void 0,decorators:[{type:_angular_core.Attribute,args:["name"]}]}],RouterOutlet.propDecorators={activateEvents:[{type:_angular_core.Output,args:["activate"]}],deactivateEvents:[{type:_angular_core.Output,args:["deactivate"]}]};var ROUTER_DIRECTIVES=[RouterOutlet,RouterLink,RouterLinkWithHref,RouterLinkActive],ROUTER_PROVIDERS=[_angular_common.Location,{provide:UrlSerializer,useClass:DefaultUrlSerializer},{provide:Router,useFactory:setupRouter,deps:[_angular_core.ApplicationRef,_angular_core.ComponentResolver,UrlSerializer,RouterOutletMap,_angular_common.Location,_angular_core.Injector,_angular_core.NgModuleFactoryLoader,ROUTES,ROUTER_CONFIGURATION]},RouterOutletMap,{provide:ActivatedRoute,useFactory:rootRoute,deps:[Router]},{provide:_angular_core.NgModuleFactoryLoader,useClass:_angular_core.SystemJsNgModuleLoader},{provide:ROUTER_CONFIGURATION,useValue:{enableTracing:!1}}],RouterModule=function(){function RouterModule(){}return RouterModule.forRoot=function(routes,config){return{ngModule:RouterModule,providers:[ROUTER_PROVIDERS,provideRoutes(routes),{provide:ROUTER_CONFIGURATION,useValue:config?config:{}},{provide:_angular_common.LocationStrategy,useFactory:provideLocationStrategy,deps:[_angular_common.PlatformLocation,[new _angular_core.Inject(_angular_common.APP_BASE_HREF),new _angular_core.Optional],ROUTER_CONFIGURATION]},provideRouterInitializer()]}},RouterModule.forChild=function(routes){return{ngModule:RouterModule,providers:[provideRoutes(routes)]}},RouterModule}();RouterModule.decorators=[{type:_angular_core.NgModule,args:[{declarations:ROUTER_DIRECTIVES,exports:ROUTER_DIRECTIVES}]}],exports.provideRouterConfig=provideRouterConfig,exports.provideRoutes=provideRoutes,exports.RouterLink=RouterLink,exports.RouterLinkWithHref=RouterLinkWithHref,exports.RouterLinkActive=RouterLinkActive,exports.RouterOutlet=RouterOutlet,exports.NavigationCancel=NavigationCancel,exports.NavigationEnd=NavigationEnd,exports.NavigationError=NavigationError,exports.NavigationStart=NavigationStart,exports.Router=Router,exports.RoutesRecognized=RoutesRecognized,exports.ROUTER_DIRECTIVES=ROUTER_DIRECTIVES,exports.RouterModule=RouterModule,exports.RouterOutletMap=RouterOutletMap,exports.provideRouter=provideRouter,exports.ActivatedRoute=ActivatedRoute,exports.ActivatedRouteSnapshot=ActivatedRouteSnapshot,exports.RouterState=RouterState,exports.RouterStateSnapshot=RouterStateSnapshot,exports.PRIMARY_OUTLET=PRIMARY_OUTLET,exports.DefaultUrlSerializer=DefaultUrlSerializer,exports.UrlSegment=UrlSegment,exports.UrlSerializer=UrlSerializer,exports.UrlTree=UrlTree});