{"version":3,"file":"web_animations_player.js","sourceRoot":"","sources":["../../../../../modules/@angular/platform-browser/src/dom/web_animations_player.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {AUTO_STYLE} from '@angular/core';\n\nimport {AnimationPlayer} from '../../core_private';\nimport {StringMapWrapper} from '../facade/collection';\nimport {isPresent} from '../facade/lang';\n\nimport {getDOM} from './dom_adapter';\nimport {DomAnimatePlayer} from './dom_animate_player';\n\nexport class WebAnimationsPlayer implements AnimationPlayer {\n  private _subscriptions: Function[] = [];\n  private _finished = false;\n  private _initialized = false;\n  private _player: DomAnimatePlayer;\n  private _started: boolean = false;\n  private _duration: number;\n\n  public parentPlayer: AnimationPlayer = null;\n\n  constructor(\n      public element: any, public keyframes: {[key: string]: string | number}[],\n      public options: {[key: string]: string | number}) {\n    this._duration = <number>options['duration'];\n  }\n\n  private _onFinish() {\n    if (!this._finished) {\n      this._finished = true;\n      if (!isPresent(this.parentPlayer)) {\n        this.destroy();\n      }\n      this._subscriptions.forEach(fn => fn());\n      this._subscriptions = [];\n    }\n  }\n\n  init(): void {\n    if (this._initialized) return;\n    this._initialized = true;\n\n    var keyframes = this.keyframes.map(styles => {\n      var formattedKeyframe: {[key: string]: string | number} = {};\n      StringMapWrapper.forEach(styles, (value: string | number, prop: string) => {\n        formattedKeyframe[prop] = value == AUTO_STYLE ? _computeStyle(this.element, prop) : value;\n      });\n      return formattedKeyframe;\n    });\n\n    this._player = this._triggerWebAnimation(this.element, keyframes, this.options);\n\n    // this is required so that the player doesn't start to animate right away\n    this.reset();\n    this._player.onfinish = () => this._onFinish();\n  }\n\n  /** @internal */\n  _triggerWebAnimation(element: any, keyframes: any[], options: any): DomAnimatePlayer {\n    return <DomAnimatePlayer>element.animate(keyframes, options);\n  }\n\n  onDone(fn: Function): void { this._subscriptions.push(fn); }\n\n  play(): void {\n    this.init();\n    this._player.play();\n  }\n\n  pause(): void {\n    this.init();\n    this._player.pause();\n  }\n\n  finish(): void {\n    this.init();\n    this._onFinish();\n    this._player.finish();\n  }\n\n  reset(): void { this._player.cancel(); }\n\n  restart(): void {\n    this.reset();\n    this.play();\n  }\n\n  hasStarted(): boolean { return this._started; }\n\n  destroy(): void {\n    this.reset();\n    this._onFinish();\n  }\n\n  get totalTime(): number { return this._duration; }\n\n  setPosition(p: number): void { this._player.currentTime = p * this.totalTime; }\n\n  getPosition(): number { return this._player.currentTime / this.totalTime; }\n}\n\nfunction _computeStyle(element: any, prop: string): string {\n  return getDOM().getComputedStyle(element)[prop];\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}